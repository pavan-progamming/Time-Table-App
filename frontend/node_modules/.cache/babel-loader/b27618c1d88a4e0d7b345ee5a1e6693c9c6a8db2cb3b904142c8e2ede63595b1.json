{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from'react';import api from'../services/api';import{jwtDecode}from'jwt-decode';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const token=localStorage.getItem('token');if(token){try{const decoded=jwtDecode(token);if(decoded.exp*1000<Date.now()){logout();}else{setUser(JSON.parse(localStorage.getItem('user')));}}catch(e){logout();}}setLoading(false);},[]);const login=async(email,password)=>{const response=await api.post('/auth/login',{email,password});const{token,user}=response.data;localStorage.setItem('token',token);localStorage.setItem('user',JSON.stringify(user));setUser(user);return user;};const register=async(username,email,password)=>{await api.post('/auth/register',{username,email,password});};const logout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,login,register,logout},children:children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","api","jwtDecode","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","token","localStorage","getItem","decoded","exp","Date","now","logout","JSON","parse","e","login","email","password","response","post","data","setItem","stringify","register","username","removeItem","Provider","value","useAuth"],"sources":["D:/time table/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport api from '../services/api';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            try {\r\n                const decoded = jwtDecode(token);\r\n                if (decoded.exp * 1000 < Date.now()) {\r\n                    logout();\r\n                } else {\r\n                    setUser(JSON.parse(localStorage.getItem('user')));\r\n                }\r\n            } catch (e) {\r\n                logout();\r\n            }\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const login = async (email, password) => {\r\n        const response = await api.post('/auth/login', { email, password });\r\n        const { token, user } = response.data;\r\n        localStorage.setItem('token', token);\r\n        localStorage.setItem('user', JSON.stringify(user));\r\n        setUser(user);\r\n        return user;\r\n    };\r\n\r\n    const register = async (username, email, password) => {\r\n        await api.post('/auth/register', { username, email, password });\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n        setUser(null);\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, loading, login, register, logout }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CAC7E,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CACjC,OAASC,SAAS,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvC,KAAM,CAAAC,WAAW,cAAGR,aAAa,CAAC,CAAC,CAEnC,MAAO,MAAM,CAAAS,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACrC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAE5CE,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAa,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAIF,KAAK,CAAE,CACP,GAAI,CACA,KAAM,CAAAG,OAAO,CAAGd,SAAS,CAACW,KAAK,CAAC,CAChC,GAAIG,OAAO,CAACC,GAAG,CAAG,IAAI,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CACjCC,MAAM,CAAC,CAAC,CACZ,CAAC,IAAM,CACHV,OAAO,CAACW,IAAI,CAACC,KAAK,CAACR,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CACrD,CACJ,CAAE,MAAOQ,CAAC,CAAE,CACRH,MAAM,CAAC,CAAC,CACZ,CACJ,CACAR,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,KAAK,CAAG,KAAAA,CAAOC,KAAK,CAAEC,QAAQ,GAAK,CACrC,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAA1B,GAAG,CAAC2B,IAAI,CAAC,aAAa,CAAE,CAAEH,KAAK,CAAEC,QAAS,CAAC,CAAC,CACnE,KAAM,CAAEb,KAAK,CAAEJ,IAAK,CAAC,CAAGkB,QAAQ,CAACE,IAAI,CACrCf,YAAY,CAACgB,OAAO,CAAC,OAAO,CAAEjB,KAAK,CAAC,CACpCC,YAAY,CAACgB,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACtB,IAAI,CAAC,CAAC,CAClDC,OAAO,CAACD,IAAI,CAAC,CACb,MAAO,CAAAA,IAAI,CACf,CAAC,CAED,KAAM,CAAAuB,QAAQ,CAAG,KAAAA,CAAOC,QAAQ,CAAER,KAAK,CAAEC,QAAQ,GAAK,CAClD,KAAM,CAAAzB,GAAG,CAAC2B,IAAI,CAAC,gBAAgB,CAAE,CAAEK,QAAQ,CAAER,KAAK,CAAEC,QAAS,CAAC,CAAC,CACnE,CAAC,CAED,KAAM,CAAAN,MAAM,CAAGA,CAAA,GAAM,CACjBN,YAAY,CAACoB,UAAU,CAAC,OAAO,CAAC,CAChCpB,YAAY,CAACoB,UAAU,CAAC,MAAM,CAAC,CAC/BxB,OAAO,CAAC,IAAI,CAAC,CACjB,CAAC,CAED,mBACIN,IAAA,CAACC,WAAW,CAAC8B,QAAQ,EAACC,KAAK,CAAE,CAAE3B,IAAI,CAAEE,OAAO,CAAEa,KAAK,CAAEQ,QAAQ,CAAEZ,MAAO,CAAE,CAAAZ,QAAA,CACnEA,QAAQ,CACS,CAAC,CAE/B,CAAC,CAED,MAAO,MAAM,CAAA6B,OAAO,CAAGA,CAAA,GAAMtC,UAAU,CAACM,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}